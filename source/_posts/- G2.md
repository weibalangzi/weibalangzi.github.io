---
title: G2图表的使用
tags:
- 图表
- G2
---
> G2是阿里开发的一套基于可视化编码的图形语法
> 以数据驱动，具有高度的易用性和扩展性

### 浏览器引入
```
<!-- 引入在线资源 -->
<script src="https://gw.alipayobjects.com/os/antv/assets/g2/3.0.5-beta.4/g2.min.js"></script>
```
### 通过npm安装
```
npm install @antv/g2 --save
```
安装完成后，使用`import`或`require`进行引用
### G2图表的组成
![](https://zos.alipayobjects.com/skylark/313254aa-ff97-4396-9192-3c0f8fc16867/attach/2378/da07b27fb885206a/image.png)
#### 坐标轴（Axis）
每个坐标轴由坐标轴线（line）、刻度线（tickLine）、刻度文本（label）、标题（title）以及网格线（grid）组成

![](https://gw.alipayobjects.com/zos/rmsportal/XyHrQpWKgHCCbctRzwVT.png)

<!--more-->

`坐标轴标题`
坐标轴的标题名默认为该轴对应数据字段的属性名，可以对标题的显示隐藏和文本内容进行修改。

```javascript
chart.axis('xField',{
    title: null // 不展示xField对应坐标轴的标题
})

chart.axis('xField',{
    title: {} // 展示xField对应坐标轴的标题
})

chart.axis('xField',{
    title: {
        textStyle: {
            fontSize: 12,
            textAlign: 'center',
            fill: '#999'
        }
    }
})
```

`为坐标轴设置别名`

```javascript
chart.scale('xField',{
    alias: '别名'
})

```
`坐标轴线line`

在line属性上进行坐标轴线的配置
```javascript
chart.axis('xField',{
    line: {
        lineWidth: 2, // 设置线的宽度
        stroke: 'red', // 设置线的颜色
        lineDash: [3,3] // 设置虚线样式
    }
})
```

`坐标轴文本label`

```javascript
// 不展示文本
chart.axis('xField',{
    label: null
})

// 配置文本显示样式
chart.axis('xField',{
    label: {
        offset: {20}, // 设置坐标轴文本label距离坐标轴线的距离
        textStyle: {
            textAlign: 'center', // 文本对齐方向，start/middle/end
            fill: 'red',
            fontSize: '16',
            fontWeight: 'bold',
            rotate: 30,
            textBaseline: 'top', // 文本基准线，top/middle/bottom
        } || {function}, // 文本样式，支持回调
        autoRotate: {boolean} // 是否需要自动旋转，默认为true
    }
})

// 格式化坐标轴文本显示
chart.axis('xField',{
    label: {
        formatter: val => {
            return val + '额外的信息'
        }
    }
})
```

`坐标轴刻度线tickLine`

在tickLine上可以配置坐标轴的长短、颜色、粗细、显示隐藏
```javascript
chart.axis('xField',{
    tickLine: {
        lineWidth: 2,
        length: 10,
        stroke: 'red'
    }
})
```

`坐标轴子刻度线subTickLine`

可以为两个主刻度间设置子刻度线的格式、样式
```javascript
chart.axis('xField',{
    subTickCount: 3,
    subTickLine: {
        lenght: 3,
        stroke: '#ddd',
        lineWidth: 1
    },
    tickLine: {
        length: 5,
        lineWidth: 2,
        stroke: '#fff'
    }
})
```

`设置坐标轴显示范围`

```javascript
// 方式1
chart.source(data,{
    xFieldli: {
        type: 'linear',
        min: 0,
        max: 1000
    }
})

// 方式2
chart.scale('xField',{
    type: 'linear',
    min: 0,
    max: 1000
})
```

`坐标轴刻度线个数`

坐标轴刻度线个数默认是5个，通过列定义，用户可以自定义坐标轴刻度线的个数

```javascript
chart.source(data,{
    xField: {
        type: 'timeCat', // 声明该数据的类型
        tickCount: 9
    }
})
```

`设置坐标轴刻度线间距`

```
// 需要注意的是tickCount和tickInterval不可以同时声明
chart.source(data,{
    xField: {
        type: 'linear',
        tickInterval: 1000
    }
})
```

`坐标系两端保留一定的空白`

对于分类数据的坐标轴两边默认会留下一定的空白，连续数据的坐标轴的两端没有空白刻度

是否两端有空白是列定义里面的range属性决定的，分类列的range的默认值是[ 1 / (count - 1), 1 - 1 / (count - 1) ]

```
chart.source(data,{
    xField: {
        type: 'cat',
        range: [0,1]
    }
})
```

### 图例（legend）

图例作为图表的辅助元素，用于标定不同的数据类型以及数据的范围

* shape,color,size这三个图形属性如果判断接收的参数是数据源的字段时，会自定生成不同的图例
* shape属性，会根据不同的shape类型生成图例
* color属性，会赋予不同的图例、不同的颜色来区分图形
* size属性，在图例上显示图形的大小

`配置图例`

```javascript
chart.legend({
    position: 'bottom', // 设置图例的显示位置
    itemGap: 20 // 图例项之间的间距
})

chart.legend('cut',false) // 不显示cut字段对应的图例

chart.legend('price',{
    title: null // 不展示图例title
})

chart.legend(false) // 所有的图例都不显示
```

`图例整体样式设置`

* position:图例的显示位置，top/left/right/bottom
* title: 用于图例标题的显示样式配置，如果值为null则不显示
* offsetX: 整个图例的水平偏移距离
* offsetY: 整个图例的垂直偏移距离
* width/height: 图例的宽高

### 几何标记

几何标记即我们所说的点、线、面这些几何图形，G2中并没有特定的图表类型的概念，用户可以单独绘制某一种类型的图表，也可以绘制混合图表。

`声明几何标记`

创建好chart对象之后，就可以选择几何标记的类型

```
const geom = chart.point().xx().xx()
```

`几何标记类型`

* point: 点，用于绘制各种点图
* path: 路径，无序的点连接而成的一条线，常用于路径图的绘制
* line: 线，点按照x轴连接成一条线，构成线图

### 提示信息（tooltip）
当鼠标悬停在图表上的某点时，以提示框的形式展示该点的数据

![](https://gw.alipayobjects.com/zos/rmsportal/VLNhkKRALafPtDCIZFqA.png)

配置tooltip的方法

* 设置在chart对象上的tooltip样式、功能相关的配置
* 设置在每个几何标记对象上的tooltip配置

关闭tooltip `chart.tooltip(false)`

配置tooltip `chart.tooltip(cfg)`

```javascript
chart.tooltip({
    triggerOn: 'mousemove'|'click'|'none', // tooltip的触发方式，默认mousemove
    showTitle: {boolean}, // 是否展示title，默认为true
    crosshairs: { // 辅助线配置
        type: 'rect' || 'x' || 'y' || 'cross',
        style: {
            // 图形样式
        }
    },
    offset: 10, // tooltip距离鼠标的偏移量
    containerTpl: `<div class="g2-tooltip">`
        + '<div class="g2-tooltip-title" style="margin:10px 0;"></div>'
        + '<ul class="g2-tooltip-list"></ul></div>', // tooltip容器模板
    itemTpl: `<li data-index={index}><span style="background-color:{color};width:8px;height:8px;border-radius:50%;display:inline-block;margin-right:8px;"></span>{name}: {value}</li>`, // 每项记录的默认模板
    inPlot: true, //将tooltip展示在指定的区域内
    follow: true, // tooltip是否跟随鼠标移动
    shared: true || false, // 默认为true，false表示只展示单条tooltip
    position: 'left' || 'right' || 'top'||'bottom' // 固定位置展示tooltip
})
```
###辅助元素（guide）
主要用于在图表上标识额外的标记注解

G2目前支持6种辅助标记类型：
* line：辅助线，例如表示平均值或者预期分布的直线
* image：辅助图片，在图表上添加辅助图片
* text：辅助文本，指定位置添加文本说明
* region：辅助框，框选一段图区，设置背景、边框等
* html：辅助html，指定位置添加自定义html，显示自定义信息；
* arc：辅助弧线

`line辅助线`

```javascript
chart.guide().line({
    start:{object} | {function} | {array}, // 辅助线起始位置
    end: {object} | {function} || {array}, // 辅助线结束位置
    lineStyle: {
        stroke: '#dded',
        lineDash: [0,1,1],
        lineWidth: 3
    },
    text: {
        position: 'start' | 'center' | 'end' | '40%' | 0.5,//文本显示位置
        autoRotate: {boolean}, // 是否沿线的角度排布,默认为true
        style: {
            // 文本图形样式配置
        },
        content: {string},// 文本的内容
        offsetX: {number},//x方向的偏移量
        offsetY：{number},//y方向的偏移量
    }
})
```



